fs = require('fs'); 
vm = require('vm');
tangoUtils = require('./tangoUtils');

/***** resolverBase *****/
resolverBase = function() {
}

resolverBase.prototype.include = function(path) {
    if (fs.statSync(path).isFile()) {
        tangoUtils.include(path);
	}

    if (fs.statSync(path).isDirectory()) {
        if (!path.endsWith('/'))
            path = path + '/';

        fs.readdirSync(path).forEach(function(file) {
            tangoUtils.include(path+file);
        });
    }
};

resolverBase.prototype.getInstance = function(model) {
	try {
        return vm.runInThisContext('new ' + model);
    } catch(err) {
        console.error('ERR: can not instantiate model "' + model + '"');
        throw err;
    }	
}

resolverBase.prototype.getUrl = function(model) {
    throw 'register has to be implemented by inherited resolver'
}

module.exports = resolverBase;
